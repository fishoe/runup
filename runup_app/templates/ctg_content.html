{% extends 'layout.html'%} {% load static %} {% block style%}
<!-- <link rel="stylesheet" type="text/css" href="{% static 'recommendapp/index.css' %}" /> -->
<link rel="stylesheet" type="text/css" media="(max-width: 480px)" href="{% static 'recommendapp/mobile_index.css' %}" />
<script src="{% static 'js/categoryPage.js' %}" defer></script>
{% endblock %} {% block content %}
<!--********************************* 카테고리 헤더 *********************************-->

<div class="category-infinite">
  <h1 class="category-infinite-title">{{ s_ctg.name_kr }}</h1>
  <section class="category-sub-section">
    <div class="category-sub">
      <div class="category-sub-filter">
        <div class="category-sub-filter-box">
          <span>필터</span>
          <i class="fas fa-chevron-down"></i>
        </div>
        <aside class="categoryFilter-dropdown-menu">
          <dl class="categoryFilter-dropdown-list">
            <dt class="sr-only">필터</dt>
            <dd>필터</dd>
          </dl>
        </aside>
      </div>

      <div class="category-sub-sort">
        <div class="category-sub-sort-box">
          <span>정렬</span>
          <i class="fas fa-chevron-down"></i>
        </div>
        <aside class="categorySort-dropdown-menu">
          <dl class="categorySort-dropdown-list">
            <dt class="sr-only">정렬</dt>
            <dd>
              <a href="#">인기순</a>
            </dd>
            <dd>
              <a href="#">상푼순</a>
            </dd>
            <dd>
              <a href="?ctg={{ctg}}&flt=1">높은가격순</a>
            </dd>
            <dd>
              <a href="?ctg={{ctg}}&flt=2">낮은가격순</a>
            </dd>
          </dl>
        </aside>
      </div>
    </div>
  </section>
  <!--********************************* 상품 목록 *********************************-->

  <div class="infinite-container">
    {% for prod in contents %}
    <div class="infinite-item">
      <div class="box">
        <div class="img_box">
          <a onclick="animation('{% url 'product' prod.id %}')">
            <img src="{{ prod.img_url }}" alt="image" class="image" />
          </a>
        </div>
        <div class="product-container">
          <div class="info">
            <b>{{ prod.brand.name_kr }}</b>
            <div class="price">{% load humanize %} {{prod.origin_price|intcomma}}원</div>
          </div>
          <!-- onclick="like_ajax('{% url 'like' prod.id %}', {{ prod.id }} )" -->
          <a class="product-image-box">
            <button class="heart-button" type="button"></button>
          </a>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
  {% if contents.has_next %}
  <a class="infinite-more-link" href="?page={{ contents.next_page_number }}&s_ctg={{s_ctg.id}}">More</a>
  {% endif %}
</div>

{% comment %} <input id="page" type="hidden" value="2" />
<button id="callmorepost" type="button" class="btn btn-primary btn-block">More Post</button>
{% endcomment %}

<script type="text/javascript">
  function animation(targetUrl) {
    var maskHeight = $(document).height();
    var windowHeight = $(window).height();
    var maskWidth = $(document).width();
    var height = $(document).scrollTop();

    var mask = "<div id='mask' style='position:absolute; z-index:9000; background-color:#000000; display:none; left:0; top:0;'></div>";
    var loadingImg = "";
    var delayTimeMillis = 1200;

    loadingImg += "<div id='loadingImg' style='position:absolute; left:10%; display:none; z-index:10000;'>";
    loadingImg += " <img src='https://mir-s3-cdn-cf.behance.net/project_modules/disp/35771931234507.564a1d2403b3a.gif'/>";
    loadingImg += "</div>";

    $("form").append(mask).append(loadingImg);

    $("#mask").css({
      width: maskWidth,
      height: maskHeight,
      opacity: "0.4",
    });

    $("#mask").show();

    if (height == 0) {
      $("#loadingImg").css({
        top: windowHeight / 3,
      });
    } else {
      $("#loadingImg").css({
        top: height + windowHeight / 3,
      });
    }

    $("#loadingImg").show();

    // 실행 지연
    setTimeout(function () {
      location.href = targetUrl;
    }, delayTimeMillis);
  }
</script>

{% endblock %}
